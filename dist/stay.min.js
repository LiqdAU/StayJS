function _defineProperty(e,s,t){return s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}window.Stay=function(e){return class{constructor(s){_defineProperty(this,"sections",[]),_defineProperty(this,"classes",{wrap:"stay-wrap",scroller:"stay-scroller",hidden:"stay-hidden",section:{class:"stay-section",active:"active-screen"},clone:{class:"clone-screen",window:"window-clone"},nav:{wrap:"stay-nav",back:"stay-go-back",next:"stay-go-next"}}),_defineProperty(this,"options",{}),_defineProperty(this,"is",{debug:!1,absolute:!1,guiding:!1,scrolling:!1,scrollScheduled:!1}),_defineProperty(this,"store",{nav:{},page:{distance:0,current:null,index:-1,previous:!1,previousIndex:-1,info:{},shouldCleanup:!0},elements:{wrap:null,scroller:null,debug:null,windowClone:null},fn:{isReady:()=>!0,onScroll:e=>this.scroll(e),hashChange:e=>this.scrollToHash(this.options.scrollToHash),simulateScroll:e=>{this.is.scrollScheduled||(this.is.scrollScheduled=!0,window.requestAnimationFrame(()=>{this.store.elements.scroller.scrollTop(this.store.elements.scroller.scrollTop()+10),this.store.fn.onScroll(),this.is.scrollScheduled=!1}))}}}),this.classes="object"==typeof s.classes?{...this.classes,...s.classes}:this.classes,this.store.elements.wrap=e(s.wrap||e(document.body)),this.reset(s);let t=this.store.elements.scroller,i=t[0]===document.documentElement?document:t;e(i).on("scroll",this.store.fn.onScroll),!0===s.simulateScroll&&e(document).on("wheel",".stay-section",e=>{this.store.fn.simulateScroll()}),window.addEventListener("hashchange",()=>{this.is.scrolling||this.store.fn.hashChange()},!1),e(document).on("click","."+this.classes.nav.back,e=>{e.preventDefault(),this.previous(this.options.navigation.options||{})}),e(document).on("click","."+this.classes.nav.next,e=>{e.preventDefault(),this.next(this.options.navigation.options||{})})}dispose(){e(this.store.elements.scroller).off("scroll",this.store.fn.onScroll),this.debug(!1),this.removeAll()}reset(s){(s={...this.options,...s}).debug=!!s.debug,s.absolute=!!s.absolute,s.navigation=s.navigation||{},s.allowScroll=!1!==s.allowScroll,s.isReady="function"!=typeof s.isReady?this.store.fn.isReady:s.isReady,s.overlayScrollbars=!1!==s.overlayScrollbars,s.scrollToHash=s.scrollToHash||{},this.sections=[],this.store.elements.scroller=e(s.scroller||document.documentElement),e("."+this.classes.clone.window).remove(),this.store.elements.windowClone=null,this.store.fn.isReady=s.isReady,this.store.elements.wrap.addClass(this.classes.wrap),this.store.elements.scroller.addClass(this.classes.scroller),this.setScroll(s.allowScroll),this.setAbsolute(s.absolute),this.setNavigation(s.navigation),s.debug&&this.debug(),Array.isArray(s.sections)&&this.add(s.sections),this.options=s}debug(s){if(this.is.debug=!1!==s,!this.is.debug)return this.store.elements.debug=!1,e(".stay-debug").css("opacity",0),void setTimeout(()=>e(".stay-debug").remove(),800);e(".stay-debug").remove();const t=e('<div class="stay-debug"></div>');t.append('<div data-debug="s">Current Section: <span></span></div>'),t.append('<div data-debug="a">Section %: <span></span>%</div>'),t.append('<div data-debug="sy">Section Y: <span></span>px</div>'),t.append('<div data-debug="y">Page Y: <span></span>px</div>'),t.css({position:"fixed",bottom:"10px",left:"10px","z-index":"9999999",background:"#fff","line-height":"1.6","box-shadow":"#7a7a7a47 0px 0px 8px",padding:"10px","border-radius":"4px","font-size":"12px","min-width":"300px","pointer-events":"none",opacity:"0.75",transition:"opacity 0.5s"}),this.sections.length||t.css("display","none"),e(document.body).append(t),this.store.elements.debug=t,this.scroll()}updateDebug(e){this.store.elements.debug&&Object.entries(e).forEach(e=>{this.store.elements.debug.find(`[data-debug="${e[0]}"] span`).text(e[1])})}toggleDebug(e){void 0===e&&(e="none"===this.store.elements.debug.css("display")),this.store.elements.debug.css("display",e?"block":"none")}triggerChange(s,t,i){this.store.nav&&!this.is.scrolling&&this.setNavigation({update:!0,fadeDelay:1e3}),e(this.store.elements.scroller).trigger("stayChange",[s,i,t])}get(e){return!!Array.isArray(this.sections)&&("number"==typeof e?this.sections[e]:this.sections.find(s=>s.name===e))}info(){return this.store.page.info}update(e){Object.entries(e).forEach(e=>{const[s,t]=e,i=this.get(s);i&&t.distance&&(i.distance=t.distance,i.clone.height(i.distance))}),this.refresh()}refresh(){let e=0,s=this.store.fn.isReady();this.forEach(s=>{s.top=e,e+=s.distance,s.isSetup||"function"!=typeof s.setup||(s.setup(s),s.isSetup=!0)}),this.store.page.distance=e,s&&this.store.page.current&&"function"==typeof this.store.page.current.before&&this.store.page.current.before(this.store.page.current),this.scroll(),setTimeout(()=>this.scroll(),500)}setNavigation(s){if((s=this._options(s,{enabled:s,hidden:!1,update:!0},!0)).hasOwnProperty("enabled"))if(s.enabled){let t=e("<nav>",{class:this.classes.nav.wrap}),i=e("<a>",{href:"#",class:this.classes.nav.back}),o=e("<a>",{href:"#",class:this.classes.nav.next});t.append([i,o]),e(this.store.elements.wrap).append(t),this.store.nav={wrap:t,back:i,next:o,updateOnChange:!0},s.update=!0}else this.store.nav&&(this.store.nav.wrap.remove(),this.store.nav=null);if(null!=this.store.nav&&(s.hasOwnProperty("hidden")&&(this.store.nav.wrap.toggleClass(this.classes.hidden,s.hidden),s.hidden&&(this.store.nav.back.addClass(this.classes.hidden),this.store.nav.next.addClass(this.classes.hidden))),s.hasOwnProperty("update")&&!0===s.update&&this.store.nav)){let e=this.store.page.current&&!1!==this.store.page.current.showNav,t=this.get(this.store.page.index+1),i=this.get(this.store.page.index-1),o=s.fadeDelay||0;if(this.store.nav.prevTimeout&&clearTimeout(this.store.nav.prevTimeout),this.store.nav.nextTimeout&&clearTimeout(this.store.nav.nextTimeout),e&&i&&!1!==i.showInNav){let e=()=>{this.store.nav.back.text(i.label||i.name).attr("href","#"+i.name),this.store.nav.back.removeClass(this.classes.hidden)};o&&this.store.nav.back.addClass(this.classes.hidden),this.store.nav.prevTimeout=o?setTimeout(e,o):e()}else this.store.nav.back.text("").addClass(this.classes.hidden);if(e&&t&&!1!==t.showInNav){let e=()=>{this.store.nav.next.text(t.label||t.name).attr("href","#"+t.name),this.store.nav.next.removeClass(this.classes.hidden)};o&&this.store.nav.next.addClass(this.classes.hidden),this.store.nav.nextTimeout=o?setTimeout(e,o):e()}else this.store.nav.next.text("").addClass(this.classes.hidden)}}setAbsolute(s){if(s=!!s,this.is.absolute=s,e(this.store.elements.wrap).toggleClass("stay-abs",s),s){let s=this.store.elements.scroller[0].scrollTop;e("."+this.classes.section.class+":visible").css("transform","translate3d(0, "+s+"px, 0)")}else e("."+this.classes.section.class).css("transform","none")}setActive(s){let t="string"==typeof s?this.sections.find(e=>e.name===s):s;t&&(e("."+this.classes.section.active).removeClass(this.classes.section.active),e(t.element).addClass(this.classes.section.active))}next(e){let s=this.get(this.store.page.index+1);s&&this.scrollTo(s,e)}previous(e){let s=this.get(this.store.page.index-1);s&&this.scrollTo(s,e)}setScroll(s){let t={overflow:s?"auto":"hidden"};s&&this.options.overlayScrollbars&&(CSS.supports("overflow","overlay")?t.overflow="overlay":CSS.supports("scrollbar-width","none")&&(t["scrollbar-width"]="none")),e(this.store.elements.scroller).css(t)}scrollToHash(e){if(!window.location.hash)return!1;const s=window.location.hash.substring(1),t=this.get(s);return!!t&&(this.scrollTo(t,e),e.clearAfterScroll&&(window.location.hash=""),!0)}scrollToTop(e){return this.scrollToY(0,e)}scrollToY(e,s){(s=s||{}).type="Y",this.scrollTo(e,s)}scrollTo(s,t){let i="number"==typeof t&&t,o=null;if((t="object"==typeof t?{...t}:{}).duration=i||t.duration||1e3,t.ease=t.ease||"swing",t.smooth=!1!==t.smooth,t.type=t.type||"index",t.hideNav=!1!==t.hideNav,"string"==typeof s&&(s=isNaN(s)?this.get(s):parseInt(s)),"number"==typeof s&&"index"==t.type&&(s=this.get(s)),"object"==typeof s){let e=s.defaultPercent||0;o=s,s=s.top||0,!0===o.disableSmooth&&(t.smooth=!1),"number"==typeof t.percent&&(e=t.percent),e?s+=o.distance/100*e+1:t.top&&(s+=t.top)}this.is.scrolling=!0;let n=this.is.absolute,a=()=>{n&&this.setAbsolute(!0),this.refresh(),t.hideNav&&this.setNavigation({hidden:!1,update:!0}),this.is.scrolling=!1,"function"==typeof t.complete&&t.complete()};if(t.hideNav&&this.setNavigation({hidden:!0}),n&&this.setAbsolute(!1),o=this.getFromY(s),"function"==typeof t.before&&t.before(o,s),t.smooth)e(this.store.elements.scroller).stop().animate({scrollTop:s},t.duration,t.ease,()=>a());else{if(e(this.store.elements.scroller)[0].scrollTo(0,s),o){const e=this.info().section,s=void 0!==e?e.index:0;this.tidyUntil(o.index,s)}a()}}tidyUntil(e,s){if(s=s||0,(e<0||e>=this.sections.length)&&(e=this.sections.length-1),s<0)s=0;else if(s>=this.sections.length)return!1;const t=s<=e,i=this.queue();if(this.store.page.current=!1,this.store.page.shouldCleanup=!1,!t){const t=s;s=e+1,e=t+1}for(let o=s;o<e;o++){let e=this.sections[o];"function"==typeof e.cleanup&&i.add(e.cleanup(e,t))}this.is.debug&&console.info("[StayJS] Cleanup running ",t?"forwards":"backwards"," from ",t?s:e," to ",t?e:s),i.run()}getFromY(e){for(let s=this.sections.length-1;s>=0;s--){let t=this.sections[s];if(t.top<=e)return t}}scroll(s){const t=this.store.elements.scroller[0].scrollTop,i=this.store.fn.isReady();let o=!1;this.store.page.forwards=this.store.page.previousY<t,this.store.page.previousY=t,this.store.page.previousIndex=this.store.page.index,this.store.page.previous=this.store.page.current;for(let s=this.sections.length-1;s>=0;s--){let n=this.sections[s];if(this.is.absolute&&e(n.element).is(":visible")&&e(n.element).css("transform","translate3d(0, "+t+"px, 0)"),!o&&n.top<=t){if(this.store.page.current=n,this.store.page.index=s,this.store.page.previousIndex!==this.store.page.index){let e=this.store.page.previousIndex<this.store.page.index;this.triggerChange(n,e,s),i&&this.store.page.shouldCleanup&&this.store.page.previous&&this.queue(this.store.page.previous.cleanup(n,e)).run(),i&&"function"==typeof n.before&&this.queue(n.before(n,e)).run(),this.setActive(n)}let e=t-n.top,a=e/n.distance;i&&"function"==typeof n.scroll&&n.scroll(a,n,e,t),!Array.isArray(n.guided)||this.is.guiding||this.is.scrolling||n.guided.filter(e=>!!e.reverse==!this.store.page.forwards).forEach(e=>{let s=parseFloat(a.toFixed(2)),t=!e.reverse&&s>=e.from&&s<e.to,i=e.reverse&&s<=e.from&&s>e.to;e.reverse=!!e.reverse,(t||i)&&(this.setScroll(!1),this.is.guiding=!0,this.scrollTo(n,{duration:e.duration||1e3,percent:100*e.to,complete:()=>{this.is.guiding=!1,this.setScroll(!0)}}))}),this.store.page.info={section:n,amount:a,top:e},this.updateDebug({s:n.name,sy:e,y:t,a:Math.floor(100*a)}),this.store.page.shouldCleanup=!0,o=!0}}}queue(e){let s={fn:new Map,run:e=>{s.fn.forEach((s,t)=>(this.is.debug&&console.info("[StayJS]","Ran queued function ",t,s),s(e)))},add:e=>{"object"==typeof e&&Object.entries(e).forEach(e=>{"function"==typeof e[1]&&s.fn.set(e[0],e[1])})}};return s.add(e),s}addClone(s,t,i){let o=e("<section>&nbsp;</section>");return o.height(s),o.addClass(this.classes.clone.class),o.addClass(i),t&&t.after(o),o}removeAll(){this.sections.forEach((e,s)=>{})}remove(e){}add(s){if(Array.isArray(s))return void s.forEach(e=>this.add(e));this.sections.length||e(document.body).addClass("stay-js"),this.store.elements.windowClone||(this.store.elements.windowClone=this.addClone("100vh",!1,this.classes.clone.window),this.store.elements.wrap.prepend(this.store.elements.windowClone)),this.is.debug&&(this.toggleDebug(!0),this.scroll());let t=e(s.selector).first();if(t.length){t.addClass(this.classes.section.class);let e=this.addClone(s.distance,t);if(s.css&&t.css(s.css),s.zindex&&t.css("z-index",s.zindex),s.top=this.store.page.distance,s.element=t[0],s.clone=e,s.index=this.sections.length,"object"==typeof s.animation){const e=s.animation;s.setup=e.setup||s.setup,s.before=e.before||s.before,s.scroll=e.scroll||s.scroll,s.cleanup=e.cleanup||s.cleanup}"function"!=typeof s.cleanup&&(s.cleanup=(()=>{})),"function"==typeof s.setup&&(s.setup(s),s.isSetup=!0),this.store.page.distance+=s.distance||0,this.sections.push(s)}}forEach(e){return this.sections.forEach(e)}_options(e,s,t){return t?"object"!=typeof e?s:e:{...s="object"==typeof s?s:{},...e="object"==typeof e?e:{}}}static split(e,s,t,i){let o=(e-(s=isNaN(s)?0:s))*(1/((t=isNaN(t)?1:t)-s));return!1!==i?Math.min(Math.max(o,0),1):o}static rsplit(e,s,t){return 1-this.split(e,s,t)}static splitInOut(e,s,t,i){s=isNaN(s)?0:s,t=isNaN(t)?.5:t,i=isNaN(i)?1:i;let o=this.split(e,s,t),n=1-this.split(e,t,i);return o<1?o:n}static splitInOutWait(e,s,t,i,o){let n=this.split(e,s,t),a=1-this.split(e,i,o);return n<1?n:e<i?1:a}static resolvePoint(e,s,t){var i=e/180*Math.PI,o=s*Math.cos(i),n=s*Math.sin(i);return{x:o+((null==t?void 0:t.x)||0),y:n+((null==t?void 0:t.y)||0)}}static ease(e,s){switch(s){case"easeIn":e=1-Math.cos(e*Math.PI/2);break;case"easeOut":e=Math.sin(e*Math.PI/2);break;case"easeInQuint":e*=e*e*e*e}return e}static tween(e,s,t,i,o){return!1!==o&&(t<0?t=0:t>1&&(t=1)),e+(t=this.ease(t,i))*(s-e)}}}(jQuery);
